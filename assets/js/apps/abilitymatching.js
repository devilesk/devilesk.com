require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({19:[function(require,module,exports){
var MobileDragDrop = require('mobile-drag-drop');
var getJSON = require('../util/getJSON');
var dragSrcEl;
var herodata;
var heroes;
var count = 0;

MobileDragDrop.polyfill();

function handleDragStart(e) {
    console.log('drag start', e, this);
    this.classList.add('dragging');

    dragSrcEl = this;

    e.dataTransfer.effectAllowed = 'move';
    e.dataTransfer.setData('text/html', this.innerHTML);
}

function handleDragEnter(e) {
  this.classList.add('dragover');
}

function handleDragOver(e) {
  if (e.preventDefault) { e.preventDefault(); }

  e.dataTransfer.dropEffect = 'move';
  return false;
}

function handleDragLeave(e) {
  this.classList.remove('dragover');
}

function handleDrop(event) {
    if (event.stopPropagation) { event.stopPropagation(); }

    if (dragSrcEl != this) {
        console.log('dragSrcEl', dragSrcEl);
        console.log('droppedEl', this);
        if (dragSrcEl.getAttribute('data-ability-index') == this.getAttribute('data-ability-index')) {
            dragSrcEl.innerHTML = this.innerHTML;
            this.innerHTML = event.dataTransfer.getData('text/html');
            this.setAttribute('draggable', false);
            dragSrcEl.setAttribute('draggable', false);
            dragSrcEl.parentNode.removeChild(dragSrcEl);
            console.log('count', count);
            count--;
            console.log('count', count);
            if (count == 0) {
                createQuestion();
            }
        }
    }
    return false;
}

function handleDragEnd(e) {
    var ul = document.getElementById('abilitybox_start');
    [].forEach.call(ul.children, function (col) {
        col.classList.remove('dragover');
        col.classList.remove('dragging');
    });
}

function createQuestion() {
    console.log('createQuestion');
    var h = heroes[Math.floor(Math.random() * heroes.length)],
        data = herodata[h],
        imgCount = 0;
    count = 0;
    document.getElementById('contentcontainer').style.display = 'none';
    document.getElementById('abilitybox_start').innerHTML = '';
    document.getElementById('abilitybox_end').innerHTML = '';
    document.getElementById('hero-portrait').innerHTML = '';
    document.getElementById('heroname').innerHTML = '';
    imgCount = data.abilities.filter(function (ability) { 
        return ability.name != 'attribute_bonus' && ability.displayname != 'Empty' && ability.displayname != '' && ability.name != 'generic_hidden';
    }).length + 1;
    
    function checkShowContent() {
        console.log('checkShowContent', imgCount);
        if (imgCount == 0) {
            document.getElementById('contentcontainer').style.display = '';
        }
    }
    var portraitImage = new Image();
    portraitImage.src = "/media/images/heroes/" + h.replace('npc_dota_hero_','') + ".png";
    portraitImage.onload = function () {
        document.getElementById('hero-portrait').src = portraitImage.src;
        imgCount--;
        checkShowContent();
    };
    document.getElementById('heroname').innerHTML = data.displayname;
    
    function setImage(element, src) {
        element.style.backgroundImage = 'url(' + src + ')';
        imgCount--;
        checkShowContent();
    }
    
    for (var i = 0; i < data.abilities.length; i++) {
        if (data.abilities[i].name != 'attribute_bonus' && data.abilities[i].displayname != 'Empty' && data.abilities[i].displayname != '' && data.abilities[i].name != 'generic_hidden') {
            count++;
            var abilityboxend = document.createElement('div');
            abilityboxend.classList.add('abilitybox_end');
            abilityboxend.id = 'ability_' + i;
            abilityboxend.setAttribute('data-ability-index', i);
            document.getElementById('abilitybox_end').appendChild(abilityboxend);
            abilityboxend.addEventListener('dragover', function (event) {
                event.preventDefault();
            });
            abilityboxend.addEventListener('dragenter', function (event) {
                event.preventDefault();
            });
            abilityboxend.addEventListener('drop', handleDrop);

            var imageUrl = "/media/images/spellicons/" + data.abilities[i].name + ".png";
            
            var abilityWrapper = document.createElement('div');
            abilityWrapper.classList.add('ability-wrapper');
            abilityWrapper.id = data.abilities[i].name;
            abilityWrapper.setAttribute('draggable', true);
            abilityWrapper.setAttribute('data-ability-index', i);
            
            var overlay = document.createElement('div');
            overlay.classList.add('overlay-hover');
            abilityWrapper.appendChild(overlay);
            
            var ability = document.createElement('div');
            ability.classList.add('abilitybox');
            abilityWrapper.appendChild(ability);

            var abilityImage = new Image();
            abilityImage.src = imageUrl;
            abilityImage.onload = setImage(ability, imageUrl);
                
            var abilityTextContainer = document.createElement('div');
            abilityTextContainer.classList.add('abilitytextcontainer');
            
            var abilityText = document.createElement('div');
            abilityText.classList.add('abilitytext');
            abilityText.innerHTML = data.abilities[i].displayname;
            abilityTextContainer.appendChild(abilityText);
            
            ability.appendChild(abilityTextContainer);
            
            document.getElementById('abilitybox_start').appendChild(abilityWrapper);
        }
    }
    
    var ul = document.getElementById('abilitybox_start');
    for (var i = ul.children.length; i >= 0; i--) {
        ul.appendChild(ul.children[Math.random() * i | 0]);
    }
    
    [].forEach.call(ul.children, function(col) {
      col.addEventListener('dragstart', handleDragStart,  false);
      //col.addEventListener('dragenter', handleDragEnter,  false);
      //col.addEventListener('dragover',  handleDragOver,   false);
      col.addEventListener('dragleave', handleDragLeave,  false);
      //col.addEventListener('drop',      handleDrop,       false);
      col.addEventListener('dragend',   handleDragEnd,    false);
    });
    console.log('count', count);
}
    
getJSON("/media/dota-json/herodata.json", function (data) {
    heroes = Object.keys(data);
    herodata = data;
        
    createQuestion();
});
},{"../util/getJSON":40,"mobile-drag-drop":14}],14:[function(require,module,exports){
/*! mobile-drag-drop 2.1.0 | Copyright (c) 2017 Tim Ruffles | MIT License */
!function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.MobileDragDrop=a.MobileDragDrop||{})}(this,function(a){"use strict";function b(){var a={dragEvents:"ondragstart"in document.documentElement,draggable:"draggable"in document.documentElement,touchEvents:"ontouchstart"in document.documentElement,userAgentSupportingNativeDnD:void 0},b=!!window.chrome||/chrome/i.test(navigator.userAgent);return a.userAgentSupportingNativeDnD=!(/iPad|iPhone|iPod|Android/.test(navigator.userAgent)||b&&a.touchEvents),A&&Object.keys(a).forEach(function(a){}),a}function c(){var a=!1;try{var b=Object.defineProperty({},"passive",{get:function(){a=!0}});window.addEventListener("test",null,b)}catch(a){}return a}function d(a){if(a&&Object.keys(a).forEach(function(b){B[b]=a[b]}),!B.forceApply){var d=b();if(d.userAgentSupportingNativeDnD&&d.draggable&&d.dragEvents)return!1}return y=c(),B.holdToDrag?h("touchstart",w,!1):h("touchstart",e,!1),!0}function e(a){if(!z){var b=f(a);if(b)try{z=new J(a,B,b,g)}catch(b){throw g(B,a,3),b}}}function f(a){var b=a.target;do if(b.draggable!==!1&&b.getAttribute&&"true"===b.getAttribute("draggable"))return b;while((b=b.parentNode)&&b!==document.body)}function g(a,b,c){if(0===c&&a.defaultActionOverride)try{a.defaultActionOverride(b),b.defaultPrevented}catch(a){}z=null}function h(a,b,c){void 0===c&&(c=!0),document.addEventListener(a,b,!!y&&{passive:c})}function i(a,b){document.removeEventListener(a,b)}function j(a){return 0===a.length?0:a.reduce(function(a,b){return b+a},0)/a.length}function k(a){return a&&a.tagName}function l(a,b){for(var c=0;c<a.changedTouches.length;c++){var d=a.changedTouches[c];if(d.identifier===b)return!0}return!1}function m(a,b,c,d,e,f,g){void 0===g&&(g=null);var h=b.changedTouches[0],i=new Event(c,{bubbles:!0,cancelable:d});i.dataTransfer=f,i.relatedTarget=g,i.screenX=h.screenX,i.screenY=h.screenY,i.clientX=h.clientX,i.clientY=h.clientY,i.pageX=h.pageX,i.pageY=h.pageY;var j=a.getBoundingClientRect();return i.offsetX=i.clientX-j.left,i.offsetY=i.clientY-j.top,i}function n(a,b,c){for(var d=[],e=[],f=0;f<b.touches.length;f++){var g=b.touches[f];d.push(g[a+"X"]),e.push(g[a+"Y"])}c.x=j(d),c.y=j(e)}function o(a,b){if(1===a.nodeType){for(var c=getComputedStyle(a),d=0;d<c.length;d++){var e=c[d];b.style.setProperty(e,c.getPropertyValue(e),c.getPropertyPriority(e))}b.style.pointerEvents="none",b.removeAttribute("id"),b.removeAttribute("class"),b.removeAttribute("draggable")}if(a.hasChildNodes())for(var d=0;d<a.childNodes.length;d++)o(a.childNodes[d],b.childNodes[d])}function p(a){var b=a.cloneNode(!0);return o(a,b),b.style.position="absolute",b.style.left="0px",b.style.top="0px",b.style.zIndex="999999",b.classList.add(G),b.classList.add(I),b}function q(a){return E.map(function(b){var c=a.style[b+"transform"];return c&&"none"!==c?c.replace(/translate\(\D*\d+[^,]*,\D*\d+[^,]*\)\s*/g,""):""})}function r(a,b,c,d,e){void 0===e&&(e=!0);var f=b.x,g=b.y;d&&(f+=d.x,g+=d.y),e&&(f-=parseInt(a.offsetWidth,10)/2,g-=parseInt(a.offsetHeight,10)/2);for(var h="translate3d("+f+"px,"+g+"px, 0)",i=0;i<E.length;i++){var j=E[i]+"transform";a.style[j]=h+" "+c[i]}}function s(a,b,c,d){var e=getComputedStyle(a);if("hidden"===e.visibility||"none"===e.display)return void d();b.classList.add(H);var f=getComputedStyle(b),g=parseFloat(f.transitionDuration);if(isNaN(g)||0===g)return void d();var h=a.getBoundingClientRect(),i={x:h.left,y:h.top};i.x+=document.body.scrollLeft||document.documentElement.scrollLeft,i.y+=document.body.scrollTop||document.documentElement.scrollTop,i.x-=parseInt(e.marginLeft,10),i.y-=parseInt(e.marginTop,10);var j=parseFloat(f.transitionDelay),k=Math.round(1e3*(g+j));r(b,i,c,void 0,!1),setTimeout(d,k)}function t(a,b){return a?a===C[0]?D[0]:0===a.indexOf(C[1])||a===C[7]?D[1]:0===a.indexOf(C[4])?D[3]:a===C[6]?D[2]:D[1]:3===b.nodeType&&"A"===b.tagName?D[3]:D[1]}function u(a,b,c,d,e,f,g){if(void 0===f&&(f=!0),void 0===g&&(g=null),A){var h=F+"debug",i=F+"event-target",j=F+"event-related-target";b.classList.add(h),b.classList.add(i),g&&(g.classList.add(h),g.classList.add(j))}var k=m(b,c,a,f,document.defaultView,e,g),l=!b.dispatchEvent(k);return d.g=0,A&&(b.classList.remove(i),g&&g.classList.remove(j)),l}function v(a,b){if(!a||a===C[7])return b;if(b===D[1]){if(0===a.indexOf(D[1]))return D[1]}else if(b===D[3]){if(0===a.indexOf(D[3])||a.indexOf("Link")>-1)return D[3]}else if(b===D[2]&&(0===a.indexOf(D[2])||a.indexOf("Move")>-1))return D[2];return D[0]}function w(a){var b=a.target,c=function(){g.off(),h.off(),i.off(),e(a)},d=function(){g.off(),h.off(),i.off(),clearTimeout(f)},f=setTimeout(c,B.holdToDrag),g=x(b,"touchend",d,this),h=x(b,"touchcancel",d,this),i=x(window,"scroll",d,this)}function x(a,b,c,d){return d&&(c=c.bind(d)),a.addEventListener(b,c),{off:function(){return a.removeEventListener(b,c)}}}var y,z,A=!1,B={iterationInterval:150},C=["none","copy","copyLink","copyMove","link","linkMove","move","all"],D=["none","copy","move","link"],E=["","-webkit-"],F="dnd-poly-",G=F+"drag-image",H=F+"snapback",I=F+"icon",J=function(){function a(a,b,c,d){this.h=a,this.i=b,this.j=c,this.k=d,this.l=0,this.m=null,this.o=null,this.p=a,this.q=a.changedTouches[0],this.s=this.t.bind(this),this.u=this.v.bind(this),h("touchmove",this.s,!1),h("touchend",this.u,!1),h("touchcancel",this.u,!1)}return a.prototype.A=function(){var a=this;this.l=1,this.B=D[0],this.C={D:{},F:void 0,g:3,G:[]},this.H={x:null,y:null},this.I={x:null,y:null};var b=this.j;if(this.J=new K(this.C,function(c,d,e){b=c,"number"!=typeof d&&"number"!=typeof e||(a.K={x:d||0,y:e||0})}),this.C.g=2,this.J.dropEffect=D[0],u("dragstart",this.j,this.p,this.C,this.J))return this.l=3,this.L(),!1;if(n("page",this.p,this.I),this.M=p(b),this.N=q(this.M),!this.K)if(this.i.dragImageOffset)this.K={x:this.i.dragImageOffset.x,y:this.i.dragImageOffset.y};else if(this.i.dragImageCenterOnTouch){var c=getComputedStyle(b);this.K={x:0-parseInt(c.marginLeft,10),y:0-parseInt(c.marginTop,10)}}else{var d=b.getBoundingClientRect(),c=getComputedStyle(b);this.K={x:d.left-this.q.clientX-parseInt(c.marginLeft,10)+d.width/2,y:d.top-this.q.clientY-parseInt(c.marginTop,10)+d.height/2}}return r(this.M,this.I,this.N,this.K,this.i.dragImageCenterOnTouch),document.body.appendChild(this.M),this.O=setInterval(function(){a.P||(a.P=!0,a.R(),a.P=!1)},this.i.iterationInterval),!0},a.prototype.L=function(){this.O&&(clearInterval(this.O),this.O=null),i("touchmove",this.s),i("touchend",this.u),i("touchcancel",this.u),this.M&&(this.M.parentNode.removeChild(this.M),this.M=null),this.k(this.i,this.p,this.l)},a.prototype.t=function(a){var b=this;if(l(a,this.q.identifier)!==!1){if(this.p=a,0===this.l){var c=void 0;if(this.i.dragStartConditionOverride)try{c=this.i.dragStartConditionOverride(a)}catch(a){c=!1}else c=1===a.touches.length;return c?void(this.A()===!0&&(this.h.preventDefault(),a.preventDefault())):void this.L()}if(a.preventDefault(),n("client",a,this.H),n("page",a,this.I),this.i.dragImageTranslateOverride)try{var d=!1;if(this.i.dragImageTranslateOverride(a,{x:this.H.x,y:this.H.y},this.m,function(a,c){b.M&&(d=!0,b.H.x+=a,b.H.y+=c,b.I.x+=a,b.I.y+=c,r(b.M,b.I,b.N,b.K,b.i.dragImageCenterOnTouch))}),d)return}catch(a){}r(this.M,this.I,this.N,this.K,this.i.dragImageCenterOnTouch)}},a.prototype.v=function(a){if(l(a,this.q.identifier)!==!1){if(this.i.dragImageTranslateOverride)try{this.i.dragImageTranslateOverride(void 0,void 0,void 0,function(){})}catch(a){}if(0===this.l)return void this.L();a.preventDefault(),this.l="touchcancel"===a.type?3:2}},a.prototype.R=function(){var a=this;if(A)var b=F+"debug",c=F+"immediate-user-selection",d=F+"current-drop-target";var e=this.B;this.C.g=3,this.J.dropEffect=D[0];var f=u("drag",this.j,this.p,this.C,this.J);if(f&&(this.B=D[0]),f||2===this.l||3===this.l){var g=this.S(this.l);return g?void s(this.j,this.M,this.N,function(){a.T()}):void this.T()}var h=document.elementFromPoint(this.H.x,this.H.y),i=this.o;h!==this.m&&h!==this.o&&(A&&(this.m&&this.m.classList.remove(c),h&&(h.classList.add(b),h.classList.add(c))),this.m=h,null!==this.o&&(this.C.g=3,this.J.dropEffect=D[0],u("dragexit",this.o,this.p,this.C,this.J,!1)),null===this.m?this.o=this.m:(this.C.g=3,this.J.dropEffect=t(this.C.F,this.j),u("dragenter",this.m,this.p,this.C,this.J)?(this.o=this.m,this.B=v(this.J.effectAllowed,this.J.dropEffect)):this.m!==document.body&&(this.o=document.body))),i!==this.o&&k(i)&&(A&&i.classList.remove(d),this.C.g=3,this.J.dropEffect=D[0],u("dragleave",i,this.p,this.C,this.J,!1,this.o)),k(this.o)&&(A&&(this.o.classList.add(b),this.o.classList.add(d)),this.C.g=3,this.J.dropEffect=t(this.C.F,this.j),u("dragover",this.o,this.p,this.C,this.J)===!1?this.B=D[0]:this.B=v(this.J.effectAllowed,this.J.dropEffect)),e!==this.B&&this.M.classList.remove(F+e);var j=F+this.B;this.M.classList.contains(j)===!1&&this.M.classList.add(j)},a.prototype.S=function(a){if(A){var b=F+"immediate-user-selection",c=F+"current-drop-target";this.o&&this.o.classList.remove(c),this.m&&this.m.classList.remove(b)}var d=this.B===D[0]||null===this.o||3===a;return d?k(this.o)&&(this.C.g=3,this.J.dropEffect=D[0],u("dragleave",this.o,this.p,this.C,this.J,!1)):k(this.o)&&(this.C.g=1,this.J.dropEffect=this.B,u("drop",this.o,this.p,this.C,this.J)===!0?this.B=this.J.dropEffect:this.B=D[0]),d},a.prototype.T=function(){this.C.g=3,this.J.dropEffect=this.B,u("dragend",this.j,this.p,this.C,this.J,!1),this.l=2,this.L()},a}(),K=function(){function a(a,b){this.U=a,this.V=b,this.W=D[0]}return Object.defineProperty(a.prototype,"types",{get:function(){if(0!==this.U.g)return Object.freeze(this.U.G)},enumerable:!0,configurable:!0}),a.prototype.setData=function(a,b){if(2===this.U.g){if(a.indexOf(" ")>-1)throw new Error("illegal arg: type contains space");this.U.D[a]=b,this.U.G.indexOf(a)===-1&&this.U.G.push(a)}},a.prototype.getData=function(a){if(1===this.U.g||2===this.U.g)return this.U.D[a]||""},a.prototype.clearData=function(a){if(2===this.U.g){if(a&&this.U.D[a]){delete this.U.D[a];var b=this.U.G.indexOf(a);return void(b>-1&&this.U.G.splice(b,1))}this.U.D={},this.U.G=[]}},a.prototype.setDragImage=function(a,b,c){2===this.U.g&&this.V(a,b,c)},Object.defineProperty(a.prototype,"effectAllowed",{get:function(){return this.U.F},set:function(a){2===this.U.g&&C.indexOf(a)>-1&&(this.U.F=a)},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"dropEffect",{get:function(){return this.W},set:function(a){0!==this.U.g&&C.indexOf(a)>-1&&(this.W=a)},enumerable:!0,configurable:!0}),a}();a.polyfill=d,Object.defineProperty(a,"__esModule",{value:!0})});

},{}]},{},[19])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9mYWN0b3ItYnVuZGxlL25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvanMvYXBwcy9hYmlsaXR5bWF0Y2hpbmcuanMiLCJub2RlX21vZHVsZXMvbW9iaWxlLWRyYWctZHJvcC9pbmRleC5taW4uanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVLQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwidmFyIE1vYmlsZURyYWdEcm9wID0gcmVxdWlyZSgnbW9iaWxlLWRyYWctZHJvcCcpO1xudmFyIGdldEpTT04gPSByZXF1aXJlKCcuLi91dGlsL2dldEpTT04nKTtcbnZhciBkcmFnU3JjRWw7XG52YXIgaGVyb2RhdGE7XG52YXIgaGVyb2VzO1xudmFyIGNvdW50ID0gMDtcblxuTW9iaWxlRHJhZ0Ryb3AucG9seWZpbGwoKTtcblxuZnVuY3Rpb24gaGFuZGxlRHJhZ1N0YXJ0KGUpIHtcbiAgICBjb25zb2xlLmxvZygnZHJhZyBzdGFydCcsIGUsIHRoaXMpO1xuICAgIHRoaXMuY2xhc3NMaXN0LmFkZCgnZHJhZ2dpbmcnKTtcblxuICAgIGRyYWdTcmNFbCA9IHRoaXM7XG5cbiAgICBlLmRhdGFUcmFuc2Zlci5lZmZlY3RBbGxvd2VkID0gJ21vdmUnO1xuICAgIGUuZGF0YVRyYW5zZmVyLnNldERhdGEoJ3RleHQvaHRtbCcsIHRoaXMuaW5uZXJIVE1MKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRHJhZ0VudGVyKGUpIHtcbiAgdGhpcy5jbGFzc0xpc3QuYWRkKCdkcmFnb3ZlcicpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEcmFnT3ZlcihlKSB7XG4gIGlmIChlLnByZXZlbnREZWZhdWx0KSB7IGUucHJldmVudERlZmF1bHQoKTsgfVxuXG4gIGUuZGF0YVRyYW5zZmVyLmRyb3BFZmZlY3QgPSAnbW92ZSc7XG4gIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRHJhZ0xlYXZlKGUpIHtcbiAgdGhpcy5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnb3ZlcicpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVEcm9wKGV2ZW50KSB7XG4gICAgaWYgKGV2ZW50LnN0b3BQcm9wYWdhdGlvbikgeyBldmVudC5zdG9wUHJvcGFnYXRpb24oKTsgfVxuXG4gICAgaWYgKGRyYWdTcmNFbCAhPSB0aGlzKSB7XG4gICAgICAgIGNvbnNvbGUubG9nKCdkcmFnU3JjRWwnLCBkcmFnU3JjRWwpO1xuICAgICAgICBjb25zb2xlLmxvZygnZHJvcHBlZEVsJywgdGhpcyk7XG4gICAgICAgIGlmIChkcmFnU3JjRWwuZ2V0QXR0cmlidXRlKCdkYXRhLWFiaWxpdHktaW5kZXgnKSA9PSB0aGlzLmdldEF0dHJpYnV0ZSgnZGF0YS1hYmlsaXR5LWluZGV4JykpIHtcbiAgICAgICAgICAgIGRyYWdTcmNFbC5pbm5lckhUTUwgPSB0aGlzLmlubmVySFRNTDtcbiAgICAgICAgICAgIHRoaXMuaW5uZXJIVE1MID0gZXZlbnQuZGF0YVRyYW5zZmVyLmdldERhdGEoJ3RleHQvaHRtbCcpO1xuICAgICAgICAgICAgdGhpcy5zZXRBdHRyaWJ1dGUoJ2RyYWdnYWJsZScsIGZhbHNlKTtcbiAgICAgICAgICAgIGRyYWdTcmNFbC5zZXRBdHRyaWJ1dGUoJ2RyYWdnYWJsZScsIGZhbHNlKTtcbiAgICAgICAgICAgIGRyYWdTcmNFbC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGRyYWdTcmNFbCk7XG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY291bnQnLCBjb3VudCk7XG4gICAgICAgICAgICBjb3VudC0tO1xuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NvdW50JywgY291bnQpO1xuICAgICAgICAgICAgaWYgKGNvdW50ID09IDApIHtcbiAgICAgICAgICAgICAgICBjcmVhdGVRdWVzdGlvbigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRHJhZ0VuZChlKSB7XG4gICAgdmFyIHVsID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FiaWxpdHlib3hfc3RhcnQnKTtcbiAgICBbXS5mb3JFYWNoLmNhbGwodWwuY2hpbGRyZW4sIGZ1bmN0aW9uIChjb2wpIHtcbiAgICAgICAgY29sLmNsYXNzTGlzdC5yZW1vdmUoJ2RyYWdvdmVyJyk7XG4gICAgICAgIGNvbC5jbGFzc0xpc3QucmVtb3ZlKCdkcmFnZ2luZycpO1xuICAgIH0pO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVRdWVzdGlvbigpIHtcbiAgICBjb25zb2xlLmxvZygnY3JlYXRlUXVlc3Rpb24nKTtcbiAgICB2YXIgaCA9IGhlcm9lc1tNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBoZXJvZXMubGVuZ3RoKV0sXG4gICAgICAgIGRhdGEgPSBoZXJvZGF0YVtoXSxcbiAgICAgICAgaW1nQ291bnQgPSAwO1xuICAgIGNvdW50ID0gMDtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGVudGNvbnRhaW5lcicpLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG4gICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2FiaWxpdHlib3hfc3RhcnQnKS5pbm5lckhUTUwgPSAnJztcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWJpbGl0eWJveF9lbmQnKS5pbm5lckhUTUwgPSAnJztcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyby1wb3J0cmFpdCcpLmlubmVySFRNTCA9ICcnO1xuICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdoZXJvbmFtZScpLmlubmVySFRNTCA9ICcnO1xuICAgIGltZ0NvdW50ID0gZGF0YS5hYmlsaXRpZXMuZmlsdGVyKGZ1bmN0aW9uIChhYmlsaXR5KSB7IFxuICAgICAgICByZXR1cm4gYWJpbGl0eS5uYW1lICE9ICdhdHRyaWJ1dGVfYm9udXMnICYmIGFiaWxpdHkuZGlzcGxheW5hbWUgIT0gJ0VtcHR5JyAmJiBhYmlsaXR5LmRpc3BsYXluYW1lICE9ICcnICYmIGFiaWxpdHkubmFtZSAhPSAnZ2VuZXJpY19oaWRkZW4nO1xuICAgIH0pLmxlbmd0aCArIDE7XG4gICAgXG4gICAgZnVuY3Rpb24gY2hlY2tTaG93Q29udGVudCgpIHtcbiAgICAgICAgY29uc29sZS5sb2coJ2NoZWNrU2hvd0NvbnRlbnQnLCBpbWdDb3VudCk7XG4gICAgICAgIGlmIChpbWdDb3VudCA9PSAwKSB7XG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY29udGVudGNvbnRhaW5lcicpLnN0eWxlLmRpc3BsYXkgPSAnJztcbiAgICAgICAgfVxuICAgIH1cbiAgICB2YXIgcG9ydHJhaXRJbWFnZSA9IG5ldyBJbWFnZSgpO1xuICAgIHBvcnRyYWl0SW1hZ2Uuc3JjID0gXCIvbWVkaWEvaW1hZ2VzL2hlcm9lcy9cIiArIGgucmVwbGFjZSgnbnBjX2RvdGFfaGVyb18nLCcnKSArIFwiLnBuZ1wiO1xuICAgIHBvcnRyYWl0SW1hZ2Uub25sb2FkID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyby1wb3J0cmFpdCcpLnNyYyA9IHBvcnRyYWl0SW1hZ2Uuc3JjO1xuICAgICAgICBpbWdDb3VudC0tO1xuICAgICAgICBjaGVja1Nob3dDb250ZW50KCk7XG4gICAgfTtcbiAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnaGVyb25hbWUnKS5pbm5lckhUTUwgPSBkYXRhLmRpc3BsYXluYW1lO1xuICAgIFxuICAgIGZ1bmN0aW9uIHNldEltYWdlKGVsZW1lbnQsIHNyYykge1xuICAgICAgICBlbGVtZW50LnN0eWxlLmJhY2tncm91bmRJbWFnZSA9ICd1cmwoJyArIHNyYyArICcpJztcbiAgICAgICAgaW1nQ291bnQtLTtcbiAgICAgICAgY2hlY2tTaG93Q29udGVudCgpO1xuICAgIH1cbiAgICBcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGRhdGEuYWJpbGl0aWVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChkYXRhLmFiaWxpdGllc1tpXS5uYW1lICE9ICdhdHRyaWJ1dGVfYm9udXMnICYmIGRhdGEuYWJpbGl0aWVzW2ldLmRpc3BsYXluYW1lICE9ICdFbXB0eScgJiYgZGF0YS5hYmlsaXRpZXNbaV0uZGlzcGxheW5hbWUgIT0gJycgJiYgZGF0YS5hYmlsaXRpZXNbaV0ubmFtZSAhPSAnZ2VuZXJpY19oaWRkZW4nKSB7XG4gICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgdmFyIGFiaWxpdHlib3hlbmQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGFiaWxpdHlib3hlbmQuY2xhc3NMaXN0LmFkZCgnYWJpbGl0eWJveF9lbmQnKTtcbiAgICAgICAgICAgIGFiaWxpdHlib3hlbmQuaWQgPSAnYWJpbGl0eV8nICsgaTtcbiAgICAgICAgICAgIGFiaWxpdHlib3hlbmQuc2V0QXR0cmlidXRlKCdkYXRhLWFiaWxpdHktaW5kZXgnLCBpKTtcbiAgICAgICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdhYmlsaXR5Ym94X2VuZCcpLmFwcGVuZENoaWxkKGFiaWxpdHlib3hlbmQpO1xuICAgICAgICAgICAgYWJpbGl0eWJveGVuZC5hZGRFdmVudExpc3RlbmVyKCdkcmFnb3ZlcicsIGZ1bmN0aW9uIChldmVudCkge1xuICAgICAgICAgICAgICAgIGV2ZW50LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIGFiaWxpdHlib3hlbmQuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VudGVyJywgZnVuY3Rpb24gKGV2ZW50KSB7XG4gICAgICAgICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYWJpbGl0eWJveGVuZC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgaGFuZGxlRHJvcCk7XG5cbiAgICAgICAgICAgIHZhciBpbWFnZVVybCA9IFwiL21lZGlhL2ltYWdlcy9zcGVsbGljb25zL1wiICsgZGF0YS5hYmlsaXRpZXNbaV0ubmFtZSArIFwiLnBuZ1wiO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgYWJpbGl0eVdyYXBwZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICAgICAgICAgIGFiaWxpdHlXcmFwcGVyLmNsYXNzTGlzdC5hZGQoJ2FiaWxpdHktd3JhcHBlcicpO1xuICAgICAgICAgICAgYWJpbGl0eVdyYXBwZXIuaWQgPSBkYXRhLmFiaWxpdGllc1tpXS5uYW1lO1xuICAgICAgICAgICAgYWJpbGl0eVdyYXBwZXIuc2V0QXR0cmlidXRlKCdkcmFnZ2FibGUnLCB0cnVlKTtcbiAgICAgICAgICAgIGFiaWxpdHlXcmFwcGVyLnNldEF0dHJpYnV0ZSgnZGF0YS1hYmlsaXR5LWluZGV4JywgaSk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBvdmVybGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBvdmVybGF5LmNsYXNzTGlzdC5hZGQoJ292ZXJsYXktaG92ZXInKTtcbiAgICAgICAgICAgIGFiaWxpdHlXcmFwcGVyLmFwcGVuZENoaWxkKG92ZXJsYXkpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgYWJpbGl0eSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgYWJpbGl0eS5jbGFzc0xpc3QuYWRkKCdhYmlsaXR5Ym94Jyk7XG4gICAgICAgICAgICBhYmlsaXR5V3JhcHBlci5hcHBlbmRDaGlsZChhYmlsaXR5KTtcblxuICAgICAgICAgICAgdmFyIGFiaWxpdHlJbWFnZSA9IG5ldyBJbWFnZSgpO1xuICAgICAgICAgICAgYWJpbGl0eUltYWdlLnNyYyA9IGltYWdlVXJsO1xuICAgICAgICAgICAgYWJpbGl0eUltYWdlLm9ubG9hZCA9IHNldEltYWdlKGFiaWxpdHksIGltYWdlVXJsKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBhYmlsaXR5VGV4dENvbnRhaW5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgICAgICAgICAgYWJpbGl0eVRleHRDb250YWluZXIuY2xhc3NMaXN0LmFkZCgnYWJpbGl0eXRleHRjb250YWluZXInKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyIGFiaWxpdHlUZXh0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICBhYmlsaXR5VGV4dC5jbGFzc0xpc3QuYWRkKCdhYmlsaXR5dGV4dCcpO1xuICAgICAgICAgICAgYWJpbGl0eVRleHQuaW5uZXJIVE1MID0gZGF0YS5hYmlsaXRpZXNbaV0uZGlzcGxheW5hbWU7XG4gICAgICAgICAgICBhYmlsaXR5VGV4dENvbnRhaW5lci5hcHBlbmRDaGlsZChhYmlsaXR5VGV4dCk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGFiaWxpdHkuYXBwZW5kQ2hpbGQoYWJpbGl0eVRleHRDb250YWluZXIpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWJpbGl0eWJveF9zdGFydCcpLmFwcGVuZENoaWxkKGFiaWxpdHlXcmFwcGVyKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICB2YXIgdWwgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYWJpbGl0eWJveF9zdGFydCcpO1xuICAgIGZvciAodmFyIGkgPSB1bC5jaGlsZHJlbi5sZW5ndGg7IGkgPj0gMDsgaS0tKSB7XG4gICAgICAgIHVsLmFwcGVuZENoaWxkKHVsLmNoaWxkcmVuW01hdGgucmFuZG9tKCkgKiBpIHwgMF0pO1xuICAgIH1cbiAgICBcbiAgICBbXS5mb3JFYWNoLmNhbGwodWwuY2hpbGRyZW4sIGZ1bmN0aW9uKGNvbCkge1xuICAgICAgY29sLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdzdGFydCcsIGhhbmRsZURyYWdTdGFydCwgIGZhbHNlKTtcbiAgICAgIC8vY29sLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdlbnRlcicsIGhhbmRsZURyYWdFbnRlciwgIGZhbHNlKTtcbiAgICAgIC8vY29sLmFkZEV2ZW50TGlzdGVuZXIoJ2RyYWdvdmVyJywgIGhhbmRsZURyYWdPdmVyLCAgIGZhbHNlKTtcbiAgICAgIGNvbC5hZGRFdmVudExpc3RlbmVyKCdkcmFnbGVhdmUnLCBoYW5kbGVEcmFnTGVhdmUsICBmYWxzZSk7XG4gICAgICAvL2NvbC5hZGRFdmVudExpc3RlbmVyKCdkcm9wJywgICAgICBoYW5kbGVEcm9wLCAgICAgICBmYWxzZSk7XG4gICAgICBjb2wuYWRkRXZlbnRMaXN0ZW5lcignZHJhZ2VuZCcsICAgaGFuZGxlRHJhZ0VuZCwgICAgZmFsc2UpO1xuICAgIH0pO1xuICAgIGNvbnNvbGUubG9nKCdjb3VudCcsIGNvdW50KTtcbn1cbiAgICBcbmdldEpTT04oXCIvbWVkaWEvZG90YS1qc29uL2hlcm9kYXRhLmpzb25cIiwgZnVuY3Rpb24gKGRhdGEpIHtcbiAgICBoZXJvZXMgPSBPYmplY3Qua2V5cyhkYXRhKTtcbiAgICBoZXJvZGF0YSA9IGRhdGE7XG4gICAgICAgIFxuICAgIGNyZWF0ZVF1ZXN0aW9uKCk7XG59KTsiLCIvKiEgbW9iaWxlLWRyYWctZHJvcCAyLjEuMCB8IENvcHlyaWdodCAoYykgMjAxNyBUaW0gUnVmZmxlcyB8IE1JVCBMaWNlbnNlICovXG4hZnVuY3Rpb24oYSxiKXtcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cyYmXCJ1bmRlZmluZWRcIiE9dHlwZW9mIG1vZHVsZT9iKGV4cG9ydHMpOlwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoW1wiZXhwb3J0c1wiXSxiKTpiKGEuTW9iaWxlRHJhZ0Ryb3A9YS5Nb2JpbGVEcmFnRHJvcHx8e30pfSh0aGlzLGZ1bmN0aW9uKGEpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIGIoKXt2YXIgYT17ZHJhZ0V2ZW50czpcIm9uZHJhZ3N0YXJ0XCJpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsZHJhZ2dhYmxlOlwiZHJhZ2dhYmxlXCJpbiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQsdG91Y2hFdmVudHM6XCJvbnRvdWNoc3RhcnRcImluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCx1c2VyQWdlbnRTdXBwb3J0aW5nTmF0aXZlRG5EOnZvaWQgMH0sYj0hIXdpbmRvdy5jaHJvbWV8fC9jaHJvbWUvaS50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpO3JldHVybiBhLnVzZXJBZ2VudFN1cHBvcnRpbmdOYXRpdmVEbkQ9ISgvaVBhZHxpUGhvbmV8aVBvZHxBbmRyb2lkLy50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpfHxiJiZhLnRvdWNoRXZlbnRzKSxBJiZPYmplY3Qua2V5cyhhKS5mb3JFYWNoKGZ1bmN0aW9uKGEpe30pLGF9ZnVuY3Rpb24gYygpe3ZhciBhPSExO3RyeXt2YXIgYj1PYmplY3QuZGVmaW5lUHJvcGVydHkoe30sXCJwYXNzaXZlXCIse2dldDpmdW5jdGlvbigpe2E9ITB9fSk7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJ0ZXN0XCIsbnVsbCxiKX1jYXRjaChhKXt9cmV0dXJuIGF9ZnVuY3Rpb24gZChhKXtpZihhJiZPYmplY3Qua2V5cyhhKS5mb3JFYWNoKGZ1bmN0aW9uKGIpe0JbYl09YVtiXX0pLCFCLmZvcmNlQXBwbHkpe3ZhciBkPWIoKTtpZihkLnVzZXJBZ2VudFN1cHBvcnRpbmdOYXRpdmVEbkQmJmQuZHJhZ2dhYmxlJiZkLmRyYWdFdmVudHMpcmV0dXJuITF9cmV0dXJuIHk9YygpLEIuaG9sZFRvRHJhZz9oKFwidG91Y2hzdGFydFwiLHcsITEpOmgoXCJ0b3VjaHN0YXJ0XCIsZSwhMSksITB9ZnVuY3Rpb24gZShhKXtpZigheil7dmFyIGI9ZihhKTtpZihiKXRyeXt6PW5ldyBKKGEsQixiLGcpfWNhdGNoKGIpe3Rocm93IGcoQixhLDMpLGJ9fX1mdW5jdGlvbiBmKGEpe3ZhciBiPWEudGFyZ2V0O2RvIGlmKGIuZHJhZ2dhYmxlIT09ITEmJmIuZ2V0QXR0cmlidXRlJiZcInRydWVcIj09PWIuZ2V0QXR0cmlidXRlKFwiZHJhZ2dhYmxlXCIpKXJldHVybiBiO3doaWxlKChiPWIucGFyZW50Tm9kZSkmJmIhPT1kb2N1bWVudC5ib2R5KX1mdW5jdGlvbiBnKGEsYixjKXtpZigwPT09YyYmYS5kZWZhdWx0QWN0aW9uT3ZlcnJpZGUpdHJ5e2EuZGVmYXVsdEFjdGlvbk92ZXJyaWRlKGIpLGIuZGVmYXVsdFByZXZlbnRlZH1jYXRjaChhKXt9ej1udWxsfWZ1bmN0aW9uIGgoYSxiLGMpe3ZvaWQgMD09PWMmJihjPSEwKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKGEsYiwhIXkmJntwYXNzaXZlOmN9KX1mdW5jdGlvbiBpKGEsYil7ZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihhLGIpfWZ1bmN0aW9uIGooYSl7cmV0dXJuIDA9PT1hLmxlbmd0aD8wOmEucmVkdWNlKGZ1bmN0aW9uKGEsYil7cmV0dXJuIGIrYX0sMCkvYS5sZW5ndGh9ZnVuY3Rpb24gayhhKXtyZXR1cm4gYSYmYS50YWdOYW1lfWZ1bmN0aW9uIGwoYSxiKXtmb3IodmFyIGM9MDtjPGEuY2hhbmdlZFRvdWNoZXMubGVuZ3RoO2MrKyl7dmFyIGQ9YS5jaGFuZ2VkVG91Y2hlc1tjXTtpZihkLmlkZW50aWZpZXI9PT1iKXJldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIG0oYSxiLGMsZCxlLGYsZyl7dm9pZCAwPT09ZyYmKGc9bnVsbCk7dmFyIGg9Yi5jaGFuZ2VkVG91Y2hlc1swXSxpPW5ldyBFdmVudChjLHtidWJibGVzOiEwLGNhbmNlbGFibGU6ZH0pO2kuZGF0YVRyYW5zZmVyPWYsaS5yZWxhdGVkVGFyZ2V0PWcsaS5zY3JlZW5YPWguc2NyZWVuWCxpLnNjcmVlblk9aC5zY3JlZW5ZLGkuY2xpZW50WD1oLmNsaWVudFgsaS5jbGllbnRZPWguY2xpZW50WSxpLnBhZ2VYPWgucGFnZVgsaS5wYWdlWT1oLnBhZ2VZO3ZhciBqPWEuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7cmV0dXJuIGkub2Zmc2V0WD1pLmNsaWVudFgtai5sZWZ0LGkub2Zmc2V0WT1pLmNsaWVudFktai50b3AsaX1mdW5jdGlvbiBuKGEsYixjKXtmb3IodmFyIGQ9W10sZT1bXSxmPTA7ZjxiLnRvdWNoZXMubGVuZ3RoO2YrKyl7dmFyIGc9Yi50b3VjaGVzW2ZdO2QucHVzaChnW2ErXCJYXCJdKSxlLnB1c2goZ1thK1wiWVwiXSl9Yy54PWooZCksYy55PWooZSl9ZnVuY3Rpb24gbyhhLGIpe2lmKDE9PT1hLm5vZGVUeXBlKXtmb3IodmFyIGM9Z2V0Q29tcHV0ZWRTdHlsZShhKSxkPTA7ZDxjLmxlbmd0aDtkKyspe3ZhciBlPWNbZF07Yi5zdHlsZS5zZXRQcm9wZXJ0eShlLGMuZ2V0UHJvcGVydHlWYWx1ZShlKSxjLmdldFByb3BlcnR5UHJpb3JpdHkoZSkpfWIuc3R5bGUucG9pbnRlckV2ZW50cz1cIm5vbmVcIixiLnJlbW92ZUF0dHJpYnV0ZShcImlkXCIpLGIucmVtb3ZlQXR0cmlidXRlKFwiY2xhc3NcIiksYi5yZW1vdmVBdHRyaWJ1dGUoXCJkcmFnZ2FibGVcIil9aWYoYS5oYXNDaGlsZE5vZGVzKCkpZm9yKHZhciBkPTA7ZDxhLmNoaWxkTm9kZXMubGVuZ3RoO2QrKylvKGEuY2hpbGROb2Rlc1tkXSxiLmNoaWxkTm9kZXNbZF0pfWZ1bmN0aW9uIHAoYSl7dmFyIGI9YS5jbG9uZU5vZGUoITApO3JldHVybiBvKGEsYiksYi5zdHlsZS5wb3NpdGlvbj1cImFic29sdXRlXCIsYi5zdHlsZS5sZWZ0PVwiMHB4XCIsYi5zdHlsZS50b3A9XCIwcHhcIixiLnN0eWxlLnpJbmRleD1cIjk5OTk5OVwiLGIuY2xhc3NMaXN0LmFkZChHKSxiLmNsYXNzTGlzdC5hZGQoSSksYn1mdW5jdGlvbiBxKGEpe3JldHVybiBFLm1hcChmdW5jdGlvbihiKXt2YXIgYz1hLnN0eWxlW2IrXCJ0cmFuc2Zvcm1cIl07cmV0dXJuIGMmJlwibm9uZVwiIT09Yz9jLnJlcGxhY2UoL3RyYW5zbGF0ZVxcKFxcRCpcXGQrW14sXSosXFxEKlxcZCtbXixdKlxcKVxccyovZyxcIlwiKTpcIlwifSl9ZnVuY3Rpb24gcihhLGIsYyxkLGUpe3ZvaWQgMD09PWUmJihlPSEwKTt2YXIgZj1iLngsZz1iLnk7ZCYmKGYrPWQueCxnKz1kLnkpLGUmJihmLT1wYXJzZUludChhLm9mZnNldFdpZHRoLDEwKS8yLGctPXBhcnNlSW50KGEub2Zmc2V0SGVpZ2h0LDEwKS8yKTtmb3IodmFyIGg9XCJ0cmFuc2xhdGUzZChcIitmK1wicHgsXCIrZytcInB4LCAwKVwiLGk9MDtpPEUubGVuZ3RoO2krKyl7dmFyIGo9RVtpXStcInRyYW5zZm9ybVwiO2Euc3R5bGVbal09aCtcIiBcIitjW2ldfX1mdW5jdGlvbiBzKGEsYixjLGQpe3ZhciBlPWdldENvbXB1dGVkU3R5bGUoYSk7aWYoXCJoaWRkZW5cIj09PWUudmlzaWJpbGl0eXx8XCJub25lXCI9PT1lLmRpc3BsYXkpcmV0dXJuIHZvaWQgZCgpO2IuY2xhc3NMaXN0LmFkZChIKTt2YXIgZj1nZXRDb21wdXRlZFN0eWxlKGIpLGc9cGFyc2VGbG9hdChmLnRyYW5zaXRpb25EdXJhdGlvbik7aWYoaXNOYU4oZyl8fDA9PT1nKXJldHVybiB2b2lkIGQoKTt2YXIgaD1hLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpLGk9e3g6aC5sZWZ0LHk6aC50b3B9O2kueCs9ZG9jdW1lbnQuYm9keS5zY3JvbGxMZWZ0fHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsTGVmdCxpLnkrPWRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wfHxkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuc2Nyb2xsVG9wLGkueC09cGFyc2VJbnQoZS5tYXJnaW5MZWZ0LDEwKSxpLnktPXBhcnNlSW50KGUubWFyZ2luVG9wLDEwKTt2YXIgaj1wYXJzZUZsb2F0KGYudHJhbnNpdGlvbkRlbGF5KSxrPU1hdGgucm91bmQoMWUzKihnK2opKTtyKGIsaSxjLHZvaWQgMCwhMSksc2V0VGltZW91dChkLGspfWZ1bmN0aW9uIHQoYSxiKXtyZXR1cm4gYT9hPT09Q1swXT9EWzBdOjA9PT1hLmluZGV4T2YoQ1sxXSl8fGE9PT1DWzddP0RbMV06MD09PWEuaW5kZXhPZihDWzRdKT9EWzNdOmE9PT1DWzZdP0RbMl06RFsxXTozPT09Yi5ub2RlVHlwZSYmXCJBXCI9PT1iLnRhZ05hbWU/RFszXTpEWzFdfWZ1bmN0aW9uIHUoYSxiLGMsZCxlLGYsZyl7aWYodm9pZCAwPT09ZiYmKGY9ITApLHZvaWQgMD09PWcmJihnPW51bGwpLEEpe3ZhciBoPUYrXCJkZWJ1Z1wiLGk9RitcImV2ZW50LXRhcmdldFwiLGo9RitcImV2ZW50LXJlbGF0ZWQtdGFyZ2V0XCI7Yi5jbGFzc0xpc3QuYWRkKGgpLGIuY2xhc3NMaXN0LmFkZChpKSxnJiYoZy5jbGFzc0xpc3QuYWRkKGgpLGcuY2xhc3NMaXN0LmFkZChqKSl9dmFyIGs9bShiLGMsYSxmLGRvY3VtZW50LmRlZmF1bHRWaWV3LGUsZyksbD0hYi5kaXNwYXRjaEV2ZW50KGspO3JldHVybiBkLmc9MCxBJiYoYi5jbGFzc0xpc3QucmVtb3ZlKGkpLGcmJmcuY2xhc3NMaXN0LnJlbW92ZShqKSksbH1mdW5jdGlvbiB2KGEsYil7aWYoIWF8fGE9PT1DWzddKXJldHVybiBiO2lmKGI9PT1EWzFdKXtpZigwPT09YS5pbmRleE9mKERbMV0pKXJldHVybiBEWzFdfWVsc2UgaWYoYj09PURbM10pe2lmKDA9PT1hLmluZGV4T2YoRFszXSl8fGEuaW5kZXhPZihcIkxpbmtcIik+LTEpcmV0dXJuIERbM119ZWxzZSBpZihiPT09RFsyXSYmKDA9PT1hLmluZGV4T2YoRFsyXSl8fGEuaW5kZXhPZihcIk1vdmVcIik+LTEpKXJldHVybiBEWzJdO3JldHVybiBEWzBdfWZ1bmN0aW9uIHcoYSl7dmFyIGI9YS50YXJnZXQsYz1mdW5jdGlvbigpe2cub2ZmKCksaC5vZmYoKSxpLm9mZigpLGUoYSl9LGQ9ZnVuY3Rpb24oKXtnLm9mZigpLGgub2ZmKCksaS5vZmYoKSxjbGVhclRpbWVvdXQoZil9LGY9c2V0VGltZW91dChjLEIuaG9sZFRvRHJhZyksZz14KGIsXCJ0b3VjaGVuZFwiLGQsdGhpcyksaD14KGIsXCJ0b3VjaGNhbmNlbFwiLGQsdGhpcyksaT14KHdpbmRvdyxcInNjcm9sbFwiLGQsdGhpcyl9ZnVuY3Rpb24geChhLGIsYyxkKXtyZXR1cm4gZCYmKGM9Yy5iaW5kKGQpKSxhLmFkZEV2ZW50TGlzdGVuZXIoYixjKSx7b2ZmOmZ1bmN0aW9uKCl7cmV0dXJuIGEucmVtb3ZlRXZlbnRMaXN0ZW5lcihiLGMpfX19dmFyIHkseixBPSExLEI9e2l0ZXJhdGlvbkludGVydmFsOjE1MH0sQz1bXCJub25lXCIsXCJjb3B5XCIsXCJjb3B5TGlua1wiLFwiY29weU1vdmVcIixcImxpbmtcIixcImxpbmtNb3ZlXCIsXCJtb3ZlXCIsXCJhbGxcIl0sRD1bXCJub25lXCIsXCJjb3B5XCIsXCJtb3ZlXCIsXCJsaW5rXCJdLEU9W1wiXCIsXCItd2Via2l0LVwiXSxGPVwiZG5kLXBvbHktXCIsRz1GK1wiZHJhZy1pbWFnZVwiLEg9RitcInNuYXBiYWNrXCIsST1GK1wiaWNvblwiLEo9ZnVuY3Rpb24oKXtmdW5jdGlvbiBhKGEsYixjLGQpe3RoaXMuaD1hLHRoaXMuaT1iLHRoaXMuaj1jLHRoaXMuaz1kLHRoaXMubD0wLHRoaXMubT1udWxsLHRoaXMubz1udWxsLHRoaXMucD1hLHRoaXMucT1hLmNoYW5nZWRUb3VjaGVzWzBdLHRoaXMucz10aGlzLnQuYmluZCh0aGlzKSx0aGlzLnU9dGhpcy52LmJpbmQodGhpcyksaChcInRvdWNobW92ZVwiLHRoaXMucywhMSksaChcInRvdWNoZW5kXCIsdGhpcy51LCExKSxoKFwidG91Y2hjYW5jZWxcIix0aGlzLnUsITEpfXJldHVybiBhLnByb3RvdHlwZS5BPWZ1bmN0aW9uKCl7dmFyIGE9dGhpczt0aGlzLmw9MSx0aGlzLkI9RFswXSx0aGlzLkM9e0Q6e30sRjp2b2lkIDAsZzozLEc6W119LHRoaXMuSD17eDpudWxsLHk6bnVsbH0sdGhpcy5JPXt4Om51bGwseTpudWxsfTt2YXIgYj10aGlzLmo7aWYodGhpcy5KPW5ldyBLKHRoaXMuQyxmdW5jdGlvbihjLGQsZSl7Yj1jLFwibnVtYmVyXCIhPXR5cGVvZiBkJiZcIm51bWJlclwiIT10eXBlb2YgZXx8KGEuSz17eDpkfHwwLHk6ZXx8MH0pfSksdGhpcy5DLmc9Mix0aGlzLkouZHJvcEVmZmVjdD1EWzBdLHUoXCJkcmFnc3RhcnRcIix0aGlzLmosdGhpcy5wLHRoaXMuQyx0aGlzLkopKXJldHVybiB0aGlzLmw9Myx0aGlzLkwoKSwhMTtpZihuKFwicGFnZVwiLHRoaXMucCx0aGlzLkkpLHRoaXMuTT1wKGIpLHRoaXMuTj1xKHRoaXMuTSksIXRoaXMuSylpZih0aGlzLmkuZHJhZ0ltYWdlT2Zmc2V0KXRoaXMuSz17eDp0aGlzLmkuZHJhZ0ltYWdlT2Zmc2V0LngseTp0aGlzLmkuZHJhZ0ltYWdlT2Zmc2V0Lnl9O2Vsc2UgaWYodGhpcy5pLmRyYWdJbWFnZUNlbnRlck9uVG91Y2gpe3ZhciBjPWdldENvbXB1dGVkU3R5bGUoYik7dGhpcy5LPXt4OjAtcGFyc2VJbnQoYy5tYXJnaW5MZWZ0LDEwKSx5OjAtcGFyc2VJbnQoYy5tYXJnaW5Ub3AsMTApfX1lbHNle3ZhciBkPWIuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCksYz1nZXRDb21wdXRlZFN0eWxlKGIpO3RoaXMuSz17eDpkLmxlZnQtdGhpcy5xLmNsaWVudFgtcGFyc2VJbnQoYy5tYXJnaW5MZWZ0LDEwKStkLndpZHRoLzIseTpkLnRvcC10aGlzLnEuY2xpZW50WS1wYXJzZUludChjLm1hcmdpblRvcCwxMCkrZC5oZWlnaHQvMn19cmV0dXJuIHIodGhpcy5NLHRoaXMuSSx0aGlzLk4sdGhpcy5LLHRoaXMuaS5kcmFnSW1hZ2VDZW50ZXJPblRvdWNoKSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKHRoaXMuTSksdGhpcy5PPXNldEludGVydmFsKGZ1bmN0aW9uKCl7YS5QfHwoYS5QPSEwLGEuUigpLGEuUD0hMSl9LHRoaXMuaS5pdGVyYXRpb25JbnRlcnZhbCksITB9LGEucHJvdG90eXBlLkw9ZnVuY3Rpb24oKXt0aGlzLk8mJihjbGVhckludGVydmFsKHRoaXMuTyksdGhpcy5PPW51bGwpLGkoXCJ0b3VjaG1vdmVcIix0aGlzLnMpLGkoXCJ0b3VjaGVuZFwiLHRoaXMudSksaShcInRvdWNoY2FuY2VsXCIsdGhpcy51KSx0aGlzLk0mJih0aGlzLk0ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLk0pLHRoaXMuTT1udWxsKSx0aGlzLmsodGhpcy5pLHRoaXMucCx0aGlzLmwpfSxhLnByb3RvdHlwZS50PWZ1bmN0aW9uKGEpe3ZhciBiPXRoaXM7aWYobChhLHRoaXMucS5pZGVudGlmaWVyKSE9PSExKXtpZih0aGlzLnA9YSwwPT09dGhpcy5sKXt2YXIgYz12b2lkIDA7aWYodGhpcy5pLmRyYWdTdGFydENvbmRpdGlvbk92ZXJyaWRlKXRyeXtjPXRoaXMuaS5kcmFnU3RhcnRDb25kaXRpb25PdmVycmlkZShhKX1jYXRjaChhKXtjPSExfWVsc2UgYz0xPT09YS50b3VjaGVzLmxlbmd0aDtyZXR1cm4gYz92b2lkKHRoaXMuQSgpPT09ITAmJih0aGlzLmgucHJldmVudERlZmF1bHQoKSxhLnByZXZlbnREZWZhdWx0KCkpKTp2b2lkIHRoaXMuTCgpfWlmKGEucHJldmVudERlZmF1bHQoKSxuKFwiY2xpZW50XCIsYSx0aGlzLkgpLG4oXCJwYWdlXCIsYSx0aGlzLkkpLHRoaXMuaS5kcmFnSW1hZ2VUcmFuc2xhdGVPdmVycmlkZSl0cnl7dmFyIGQ9ITE7aWYodGhpcy5pLmRyYWdJbWFnZVRyYW5zbGF0ZU92ZXJyaWRlKGEse3g6dGhpcy5ILngseTp0aGlzLkgueX0sdGhpcy5tLGZ1bmN0aW9uKGEsYyl7Yi5NJiYoZD0hMCxiLkgueCs9YSxiLkgueSs9YyxiLkkueCs9YSxiLkkueSs9YyxyKGIuTSxiLkksYi5OLGIuSyxiLmkuZHJhZ0ltYWdlQ2VudGVyT25Ub3VjaCkpfSksZClyZXR1cm59Y2F0Y2goYSl7fXIodGhpcy5NLHRoaXMuSSx0aGlzLk4sdGhpcy5LLHRoaXMuaS5kcmFnSW1hZ2VDZW50ZXJPblRvdWNoKX19LGEucHJvdG90eXBlLnY9ZnVuY3Rpb24oYSl7aWYobChhLHRoaXMucS5pZGVudGlmaWVyKSE9PSExKXtpZih0aGlzLmkuZHJhZ0ltYWdlVHJhbnNsYXRlT3ZlcnJpZGUpdHJ5e3RoaXMuaS5kcmFnSW1hZ2VUcmFuc2xhdGVPdmVycmlkZSh2b2lkIDAsdm9pZCAwLHZvaWQgMCxmdW5jdGlvbigpe30pfWNhdGNoKGEpe31pZigwPT09dGhpcy5sKXJldHVybiB2b2lkIHRoaXMuTCgpO2EucHJldmVudERlZmF1bHQoKSx0aGlzLmw9XCJ0b3VjaGNhbmNlbFwiPT09YS50eXBlPzM6Mn19LGEucHJvdG90eXBlLlI9ZnVuY3Rpb24oKXt2YXIgYT10aGlzO2lmKEEpdmFyIGI9RitcImRlYnVnXCIsYz1GK1wiaW1tZWRpYXRlLXVzZXItc2VsZWN0aW9uXCIsZD1GK1wiY3VycmVudC1kcm9wLXRhcmdldFwiO3ZhciBlPXRoaXMuQjt0aGlzLkMuZz0zLHRoaXMuSi5kcm9wRWZmZWN0PURbMF07dmFyIGY9dShcImRyYWdcIix0aGlzLmosdGhpcy5wLHRoaXMuQyx0aGlzLkopO2lmKGYmJih0aGlzLkI9RFswXSksZnx8Mj09PXRoaXMubHx8Mz09PXRoaXMubCl7dmFyIGc9dGhpcy5TKHRoaXMubCk7cmV0dXJuIGc/dm9pZCBzKHRoaXMuaix0aGlzLk0sdGhpcy5OLGZ1bmN0aW9uKCl7YS5UKCl9KTp2b2lkIHRoaXMuVCgpfXZhciBoPWRvY3VtZW50LmVsZW1lbnRGcm9tUG9pbnQodGhpcy5ILngsdGhpcy5ILnkpLGk9dGhpcy5vO2ghPT10aGlzLm0mJmghPT10aGlzLm8mJihBJiYodGhpcy5tJiZ0aGlzLm0uY2xhc3NMaXN0LnJlbW92ZShjKSxoJiYoaC5jbGFzc0xpc3QuYWRkKGIpLGguY2xhc3NMaXN0LmFkZChjKSkpLHRoaXMubT1oLG51bGwhPT10aGlzLm8mJih0aGlzLkMuZz0zLHRoaXMuSi5kcm9wRWZmZWN0PURbMF0sdShcImRyYWdleGl0XCIsdGhpcy5vLHRoaXMucCx0aGlzLkMsdGhpcy5KLCExKSksbnVsbD09PXRoaXMubT90aGlzLm89dGhpcy5tOih0aGlzLkMuZz0zLHRoaXMuSi5kcm9wRWZmZWN0PXQodGhpcy5DLkYsdGhpcy5qKSx1KFwiZHJhZ2VudGVyXCIsdGhpcy5tLHRoaXMucCx0aGlzLkMsdGhpcy5KKT8odGhpcy5vPXRoaXMubSx0aGlzLkI9dih0aGlzLkouZWZmZWN0QWxsb3dlZCx0aGlzLkouZHJvcEVmZmVjdCkpOnRoaXMubSE9PWRvY3VtZW50LmJvZHkmJih0aGlzLm89ZG9jdW1lbnQuYm9keSkpKSxpIT09dGhpcy5vJiZrKGkpJiYoQSYmaS5jbGFzc0xpc3QucmVtb3ZlKGQpLHRoaXMuQy5nPTMsdGhpcy5KLmRyb3BFZmZlY3Q9RFswXSx1KFwiZHJhZ2xlYXZlXCIsaSx0aGlzLnAsdGhpcy5DLHRoaXMuSiwhMSx0aGlzLm8pKSxrKHRoaXMubykmJihBJiYodGhpcy5vLmNsYXNzTGlzdC5hZGQoYiksdGhpcy5vLmNsYXNzTGlzdC5hZGQoZCkpLHRoaXMuQy5nPTMsdGhpcy5KLmRyb3BFZmZlY3Q9dCh0aGlzLkMuRix0aGlzLmopLHUoXCJkcmFnb3ZlclwiLHRoaXMubyx0aGlzLnAsdGhpcy5DLHRoaXMuSik9PT0hMT90aGlzLkI9RFswXTp0aGlzLkI9dih0aGlzLkouZWZmZWN0QWxsb3dlZCx0aGlzLkouZHJvcEVmZmVjdCkpLGUhPT10aGlzLkImJnRoaXMuTS5jbGFzc0xpc3QucmVtb3ZlKEYrZSk7dmFyIGo9Rit0aGlzLkI7dGhpcy5NLmNsYXNzTGlzdC5jb250YWlucyhqKT09PSExJiZ0aGlzLk0uY2xhc3NMaXN0LmFkZChqKX0sYS5wcm90b3R5cGUuUz1mdW5jdGlvbihhKXtpZihBKXt2YXIgYj1GK1wiaW1tZWRpYXRlLXVzZXItc2VsZWN0aW9uXCIsYz1GK1wiY3VycmVudC1kcm9wLXRhcmdldFwiO3RoaXMubyYmdGhpcy5vLmNsYXNzTGlzdC5yZW1vdmUoYyksdGhpcy5tJiZ0aGlzLm0uY2xhc3NMaXN0LnJlbW92ZShiKX12YXIgZD10aGlzLkI9PT1EWzBdfHxudWxsPT09dGhpcy5vfHwzPT09YTtyZXR1cm4gZD9rKHRoaXMubykmJih0aGlzLkMuZz0zLHRoaXMuSi5kcm9wRWZmZWN0PURbMF0sdShcImRyYWdsZWF2ZVwiLHRoaXMubyx0aGlzLnAsdGhpcy5DLHRoaXMuSiwhMSkpOmsodGhpcy5vKSYmKHRoaXMuQy5nPTEsdGhpcy5KLmRyb3BFZmZlY3Q9dGhpcy5CLHUoXCJkcm9wXCIsdGhpcy5vLHRoaXMucCx0aGlzLkMsdGhpcy5KKT09PSEwP3RoaXMuQj10aGlzLkouZHJvcEVmZmVjdDp0aGlzLkI9RFswXSksZH0sYS5wcm90b3R5cGUuVD1mdW5jdGlvbigpe3RoaXMuQy5nPTMsdGhpcy5KLmRyb3BFZmZlY3Q9dGhpcy5CLHUoXCJkcmFnZW5kXCIsdGhpcy5qLHRoaXMucCx0aGlzLkMsdGhpcy5KLCExKSx0aGlzLmw9Mix0aGlzLkwoKX0sYX0oKSxLPWZ1bmN0aW9uKCl7ZnVuY3Rpb24gYShhLGIpe3RoaXMuVT1hLHRoaXMuVj1iLHRoaXMuVz1EWzBdfXJldHVybiBPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJ0eXBlc1wiLHtnZXQ6ZnVuY3Rpb24oKXtpZigwIT09dGhpcy5VLmcpcmV0dXJuIE9iamVjdC5mcmVlemUodGhpcy5VLkcpfSxlbnVtZXJhYmxlOiEwLGNvbmZpZ3VyYWJsZTohMH0pLGEucHJvdG90eXBlLnNldERhdGE9ZnVuY3Rpb24oYSxiKXtpZigyPT09dGhpcy5VLmcpe2lmKGEuaW5kZXhPZihcIiBcIik+LTEpdGhyb3cgbmV3IEVycm9yKFwiaWxsZWdhbCBhcmc6IHR5cGUgY29udGFpbnMgc3BhY2VcIik7dGhpcy5VLkRbYV09Yix0aGlzLlUuRy5pbmRleE9mKGEpPT09LTEmJnRoaXMuVS5HLnB1c2goYSl9fSxhLnByb3RvdHlwZS5nZXREYXRhPWZ1bmN0aW9uKGEpe2lmKDE9PT10aGlzLlUuZ3x8Mj09PXRoaXMuVS5nKXJldHVybiB0aGlzLlUuRFthXXx8XCJcIn0sYS5wcm90b3R5cGUuY2xlYXJEYXRhPWZ1bmN0aW9uKGEpe2lmKDI9PT10aGlzLlUuZyl7aWYoYSYmdGhpcy5VLkRbYV0pe2RlbGV0ZSB0aGlzLlUuRFthXTt2YXIgYj10aGlzLlUuRy5pbmRleE9mKGEpO3JldHVybiB2b2lkKGI+LTEmJnRoaXMuVS5HLnNwbGljZShiLDEpKX10aGlzLlUuRD17fSx0aGlzLlUuRz1bXX19LGEucHJvdG90eXBlLnNldERyYWdJbWFnZT1mdW5jdGlvbihhLGIsYyl7Mj09PXRoaXMuVS5nJiZ0aGlzLlYoYSxiLGMpfSxPYmplY3QuZGVmaW5lUHJvcGVydHkoYS5wcm90b3R5cGUsXCJlZmZlY3RBbGxvd2VkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiB0aGlzLlUuRn0sc2V0OmZ1bmN0aW9uKGEpezI9PT10aGlzLlUuZyYmQy5pbmRleE9mKGEpPi0xJiYodGhpcy5VLkY9YSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksT2JqZWN0LmRlZmluZVByb3BlcnR5KGEucHJvdG90eXBlLFwiZHJvcEVmZmVjdFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5XfSxzZXQ6ZnVuY3Rpb24oYSl7MCE9PXRoaXMuVS5nJiZDLmluZGV4T2YoYSk+LTEmJih0aGlzLlc9YSl9LGVudW1lcmFibGU6ITAsY29uZmlndXJhYmxlOiEwfSksYX0oKTthLnBvbHlmaWxsPWQsT2JqZWN0LmRlZmluZVByb3BlcnR5KGEsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSl9KTtcbi8vIyBzb3VyY2VNYXBwaW5nVVJMPWluZGV4Lm1pbi5qcy5tYXAiXX0=
